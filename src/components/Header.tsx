import Link from "next/link";
import { useAuth } from "../hooks/useAuth";
import { Button } from "./Button";

function truncate(text = "", startChars = 5, endChars = 3, maxLength = 11) {
  if (text.length > maxLength) {
    var start = text.substring(0, startChars);
    var end = text.substring(text.length - endChars, text.length);
    while (start.length + end.length < maxLength) {
      start = start + ".";
    }
    return start + end;
  }
  return text;
}

const Header = () => {
  const { isAuthenticated, user, login, logout } = useAuth();

  return (
    <nav className="flex-none">
      <div className="pr-4 flex space-x-4 sm:space-x-8 h-16 items-center mb-8">
        <Link href="/">
          <svg
            width="169"
            height="43"
            viewBox="0 0 169 43"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M66 34.6352C66 35.7873 65.3782 36.8519 64.3689 37.428L57.115 41.5679C56.1057 42.1439 54.8621 42.1439 53.8527 41.5679L46.5989 37.428C45.5895 36.8519 44.9678 35.7873 44.9678 34.6352V26.3554L43.1087 25.2944C40.8907 28.5138 37.1527 30.6278 32.9152 30.6278C28.7083 30.6278 24.9937 28.5442 22.77 25.3639L21.0322 26.3557V34.6355C21.0322 35.7876 20.4105 36.8522 19.4011 37.4282L12.1473 41.5681C11.1379 42.1442 9.89433 42.1442 8.88498 41.5681L1.63115 37.4282C0.621789 36.8522 0 35.7876 0 34.6355V26.3557C0 25.2036 0.621789 24.139 1.63115 23.563L8.88498 19.4231C9.89434 18.847 11.1379 18.847 12.1473 19.4231L19.4011 23.563C19.519 23.6302 19.6316 23.7042 19.7385 23.7841L21.4128 22.8286C20.882 21.4684 20.591 19.9904 20.591 18.4452C20.591 16.5446 21.0313 14.7457 21.8165 13.1427L18.5115 11.2564L15.4593 16.4821C15.043 17.195 14.1209 17.4392 13.3997 17.0277C12.6786 16.6161 12.4315 15.7046 12.8478 14.9917L15.9 9.76601L14.6443 9.04938L12.9225 11.9973C12.372 12.9399 11.1527 13.2628 10.1992 12.7186C9.24567 12.1744 8.91897 10.9692 9.46949 10.0266L11.1913 7.07867L9.93561 6.36205L7.03224 11.333C6.63042 12.021 5.74048 12.2567 5.04449 11.8595C4.34851 11.4623 4.11005 10.5826 4.51188 9.89461L7.41523 4.92364L5.22689 3.67471C4.53341 3.27893 4.2958 2.40237 4.69618 1.71686C5.09656 1.03135 5.98332 0.796478 6.6768 1.19226L23.3807 10.7254C25.6409 8.00094 29.0727 6.26261 32.9152 6.26261C36.7887 6.26261 40.2448 8.02904 42.5041 10.7914L59.3232 1.1925C60.0167 0.796722 60.9034 1.0316 61.3038 1.71711C61.7042 2.40262 61.4666 3.27918 60.7731 3.67496L58.5848 4.92388L61.4881 9.89485C61.8899 10.5828 61.6515 11.4626 60.9555 11.8598C60.2595 12.257 59.3696 12.0212 58.9678 11.3333L56.0644 6.36229L54.8087 7.07892L56.5305 10.0268C57.081 10.9694 56.7543 12.1747 55.8008 12.7189C54.8473 13.2631 53.628 12.9401 53.0775 11.9975L51.3557 9.04963L50.1 9.76625L53.1522 14.992C53.5685 15.7048 53.3214 16.6163 52.6003 17.0279C51.8791 17.4395 50.957 17.1952 50.5407 16.4824L47.4885 11.2567L44.0508 13.2186C44.8129 14.8025 45.2394 16.5746 45.2394 18.4452C45.2394 19.9603 44.9596 21.4109 44.4483 22.7491L46.2615 23.7839C46.3684 23.7039 46.481 23.63 46.5989 23.5627L53.8527 19.4228C54.8621 18.8468 56.1057 18.8468 57.115 19.4228L64.3689 23.5627C65.3782 24.1388 66 25.2034 66 26.3555V34.6352ZM62.9189 34.9455L55.6651 39.0854C55.553 39.1494 55.4148 39.1494 55.3026 39.0854L48.0488 34.9455C47.9367 34.8815 47.8676 34.7632 47.8676 34.6352V26.3555C47.8676 26.2275 47.9367 26.1092 48.0488 26.0452L55.3026 21.9053C55.4148 21.8413 55.553 21.8413 55.6651 21.9053L62.9189 26.0452C63.0311 26.1092 63.1002 26.2275 63.1002 26.3555V34.6352C63.1002 34.7632 63.0311 34.8815 62.9189 34.9455ZM60.9774 33.01C60.9774 33.394 60.7701 33.7489 60.4337 33.9409L57.5972 35.5597C57.2607 35.7517 56.8462 35.7517 56.5097 35.5597L53.6732 33.9409C53.3368 33.7489 53.1295 33.394 53.1295 33.01V29.7723C53.1295 29.3883 53.3368 29.0334 53.6732 28.8414L56.5097 27.2226C56.8462 27.0305 57.2607 27.0305 57.5972 27.2226L60.4337 28.8414C60.7701 29.0334 60.9774 29.3883 60.9774 29.7723V33.01ZM58.0776 30.8067V31.9756L57.0534 32.5601L56.0293 31.9756V30.8067L57.0534 30.2222L58.0776 30.8067ZM3.08105 34.9458L10.3349 39.0857C10.447 39.1497 10.5852 39.1497 10.6974 39.0857L17.9512 34.9458C18.0633 34.8818 18.1324 34.7635 18.1324 34.6355V26.3557C18.1324 26.2277 18.0633 26.1094 17.9512 26.0454L10.6974 21.9055C10.5852 21.8415 10.447 21.8415 10.3349 21.9055L3.08105 26.0454C2.9689 26.1094 2.89981 26.2277 2.89981 26.3557L2.89981 34.6355C2.89981 34.7635 2.9689 34.8818 3.08105 34.9458ZM5.02263 33.0102C5.02263 33.3943 5.22989 33.7491 5.56634 33.9411L8.40284 35.56C8.73929 35.752 9.15382 35.752 9.49027 35.56L12.3268 33.9411C12.6632 33.7491 12.8705 33.3943 12.8705 33.0102L12.8705 29.7726C12.8705 29.3885 12.6632 29.0336 12.3268 28.8416L9.49027 27.2228C9.15382 27.0308 8.73929 27.0308 8.40284 27.2228L5.56634 28.8416C5.22989 29.0336 5.02263 29.3885 5.02263 29.7726L5.02263 33.0102ZM7.92244 30.8069V31.9759L8.94655 32.5603L9.97067 31.9759V30.8069L8.94655 30.2224L7.92244 30.8069ZM39.2586 18.3523V17.0845H37.8827V12.7122H35.7139V17.0845H30.3502V12.7122H28.1873V17.0845H26.7531V18.3523H28.1873V20.4232C28.1873 21.2684 28.3875 22.0119 28.7878 22.6535C29.192 23.2951 29.7575 23.7965 30.4843 24.1576C31.2112 24.5149 32.0604 24.6936 33.0321 24.6936C34.0037 24.6936 34.853 24.5149 35.5798 24.1576C36.3066 23.7965 36.8721 23.2951 37.2763 22.6535C37.6806 22.0119 37.8827 21.2684 37.8827 20.4232V18.3523H39.2586ZM35.7139 18.3523H30.3502V20.2445C30.3502 20.7363 30.4591 21.1743 30.6767 21.5585C30.8983 21.9427 31.2092 22.2443 31.6095 22.4633C32.0138 22.6785 32.4879 22.786 33.0321 22.786C33.5801 22.786 34.0543 22.6785 34.4546 22.4633C34.8588 22.2443 35.1698 21.9427 35.3874 21.5585C35.6051 21.1743 35.7139 20.7363 35.7139 20.2445V18.3523Z"
              fill="#3F4F57"
            />
            <path
              d="M77.192 21V4.752H74.264V1.56H84.416V4.752H81.512V21H77.192ZM84.6275 21V1.56H89.9795C91.2915 1.56 92.4275 1.704 93.3875 1.992C94.3475 2.28 95.0915 2.8 95.6195 3.552C96.1635 4.288 96.4355 5.336 96.4355 6.696C96.4355 7.496 96.3715 8.208 96.2435 8.832C96.1155 9.456 95.8755 10 95.5235 10.464C95.1875 10.912 94.6995 11.288 94.0595 11.592L96.7235 21H92.2835L90.1475 12.288H88.9235V21H84.6275ZM88.9235 9.816H90.1235C90.7315 9.816 91.2035 9.712 91.5395 9.504C91.8755 9.28 92.1075 8.968 92.2355 8.568C92.3795 8.152 92.4515 7.656 92.4515 7.08C92.4515 6.248 92.2995 5.6 91.9955 5.136C91.6915 4.672 91.1315 4.44 90.3155 4.44H88.9235V9.816ZM97.5181 21V1.56H106.254V4.488H101.814V9.312H105.198V12.288H101.814V18.096H106.302V21H97.5181ZM105.817 21L109.489 1.56H114.385L118.009 21H114.049L113.401 16.896H110.545L109.873 21H105.817ZM110.929 14.328H112.993L111.961 6.744L110.929 14.328ZM123.444 21.288C122.228 21.288 121.212 21.072 120.396 20.64C119.58 20.208 118.964 19.544 118.548 18.648C118.132 17.736 117.9 16.56 117.852 15.12L121.524 14.568C121.54 15.4 121.612 16.072 121.74 16.584C121.884 17.096 122.076 17.464 122.316 17.688C122.572 17.912 122.876 18.024 123.228 18.024C123.676 18.024 123.964 17.872 124.092 17.568C124.236 17.264 124.308 16.944 124.308 16.608C124.308 15.808 124.116 15.136 123.732 14.592C123.348 14.032 122.828 13.472 122.172 12.912L120.492 11.448C119.756 10.824 119.132 10.12 118.62 9.336C118.124 8.536 117.876 7.552 117.876 6.384C117.876 4.736 118.364 3.48 119.34 2.616C120.316 1.736 121.644 1.296 123.324 1.296C124.364 1.296 125.196 1.472 125.82 1.824C126.46 2.176 126.94 2.64 127.26 3.216C127.596 3.776 127.82 4.376 127.932 5.016C128.06 5.64 128.132 6.24 128.148 6.816L124.452 7.272C124.436 6.696 124.396 6.2 124.332 5.784C124.284 5.352 124.172 5.024 123.996 4.8C123.82 4.56 123.548 4.44 123.18 4.44C122.78 4.44 122.484 4.608 122.292 4.944C122.116 5.28 122.028 5.616 122.028 5.952C122.028 6.672 122.196 7.264 122.532 7.728C122.884 8.176 123.34 8.648 123.9 9.144L125.508 10.56C126.356 11.28 127.068 12.096 127.644 13.008C128.236 13.92 128.532 15.048 128.532 16.392C128.532 17.304 128.324 18.136 127.908 18.888C127.492 19.624 126.9 20.208 126.132 20.64C125.38 21.072 124.484 21.288 123.444 21.288ZM134.728 21.288C133.24 21.288 132.072 21.048 131.224 20.568C130.392 20.072 129.808 19.36 129.472 18.432C129.136 17.488 128.968 16.336 128.968 14.976V1.56H133.216V15.624C133.216 16.024 133.248 16.424 133.312 16.824C133.376 17.224 133.512 17.552 133.72 17.808C133.944 18.064 134.28 18.192 134.728 18.192C135.192 18.192 135.528 18.064 135.736 17.808C135.944 17.552 136.072 17.224 136.12 16.824C136.184 16.424 136.216 16.024 136.216 15.624V1.56H140.488V14.976C140.488 16.336 140.312 17.488 139.96 18.432C139.624 19.36 139.04 20.072 138.208 20.568C137.376 21.048 136.216 21.288 134.728 21.288ZM141.721 21V1.56H147.073C148.385 1.56 149.521 1.704 150.481 1.992C151.441 2.28 152.185 2.8 152.713 3.552C153.257 4.288 153.529 5.336 153.529 6.696C153.529 7.496 153.465 8.208 153.337 8.832C153.209 9.456 152.969 10 152.617 10.464C152.281 10.912 151.793 11.288 151.153 11.592L153.817 21H149.377L147.241 12.288H146.017V21H141.721ZM146.017 9.816H147.217C147.825 9.816 148.297 9.712 148.633 9.504C148.969 9.28 149.201 8.968 149.329 8.568C149.473 8.152 149.545 7.656 149.545 7.08C149.545 6.248 149.393 5.6 149.089 5.136C148.785 4.672 148.225 4.44 147.409 4.44H146.017V9.816ZM154.612 21V1.56H163.348V4.488H158.908V9.312H162.292V12.288H158.908V18.096H163.396V21H154.612ZM75.512 42V22.56H79.808V30.432H82.808V22.56H87.128V42H82.808V33.504H79.808V42H75.512ZM94.2044 42.288C92.7164 42.288 91.5484 42.048 90.7004 41.568C89.8684 41.072 89.2844 40.36 88.9484 39.432C88.6124 38.488 88.4444 37.336 88.4444 35.976V22.56H92.6924V36.624C92.6924 37.024 92.7244 37.424 92.7884 37.824C92.8524 38.224 92.9884 38.552 93.1964 38.808C93.4204 39.064 93.7564 39.192 94.2044 39.192C94.6684 39.192 95.0044 39.064 95.2124 38.808C95.4204 38.552 95.5484 38.224 95.5964 37.824C95.6604 37.424 95.6924 37.024 95.6924 36.624V22.56H99.9644V35.976C99.9644 37.336 99.7884 38.488 99.4364 39.432C99.1004 40.36 98.5164 41.072 97.6844 41.568C96.8524 42.048 95.6924 42.288 94.2044 42.288ZM101.198 42V22.56H104.222L108.206 31.92V22.56H111.758V42H108.854L104.87 31.92V42H101.198ZM114.903 42V25.752H111.975V22.56H122.127V25.752H119.223V42H114.903Z"
              fill="#3F4F57"
            />
          </svg>
        </Link>
        <span className="grow"></span>
        {isAuthenticated && user ? (
          <Button
            onClick={() => {
              logout();
            }}
          >
            Logout ({truncate(user)})
          </Button>
        ) : (
          <Button
            onClick={() => {
              login();
            }}
          >
            Connect Wallet
          </Button>
        )}
      </div>
    </nav>
  );
};

export default Header;
